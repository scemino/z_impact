const std = @import("std");
const sokol = @import("sokol");
const sapp = sokol.app;
const Engine = @import("engine.zig").Engine;
const render = @import("render.zig");
const types = @import("types.zig");
const vec2 = types.vec2;
const stm = @import("sokol").time;
const Map = @import("map.zig").Map;
const entity = @import("entity.zig");
const title = @import("scenes/title.zig");
const game = @import("game.zig");
const EntityVtab = @import("entity.zig").EntityVtab;

var map: Map = undefined;
var blob_entity: game.Entity = undefined;
var player_entity: game.Entity = undefined;

const engine = Engine(game.Entity);
var vtabs: [@typeInfo(game.EntityKind).Enum.fields.len]EntityVtab(game.Entity) = undefined;

export fn init() void {
    stm.setup();

    vtabs = [_]EntityVtab(game.Entity){
        game.blob.vtab,
        game.player.vtab,
    };
    engine.init(&vtabs);

    map = Map.initFromJson(
        \\{
        \\			"name": "main",
        \\			"width": 256,
        \\			"height": 20,
        \\			"linkWithCollision": true,
        \\			"visible": true,
        \\			"tilesetName": "assets/tiles/biolab.qoi",
        \\			"repeat": false,
        \\			"distance": 1,
        \\			"tilesize": 8,
        \\			"foreground": false,
        \\			"data": [
        \\				[79,77,77,78,77,79,77,77,78,77,78,77,79,77,77,71,63,77,77,77,78,77,77,78,77,4,3,1,3,1,4,5,2,26,27,27,28,2,1,5,4,22,1,4,5,1,78,79,62,71,59,78,77,78,78,77,77,77,78,77,79,71,77,79,77,77,77,77,77,77,78,71,78,77,77,78,77,77,77,61,77,78,77,78,77,78,77,78,19,79,77,77,79,77,4,5,78,75,57,58,62,19,34,19,60,61,58,74,77,5,4,78,63,77,78,56,78,78,57,78,58,78,78,55,78,1,4,7,26,27,28,3,23,1,26,27,28,1,3,1,2,1,21,4,1,21,1,26,27,28,4,5,3,26,27,28,5,2,4,3,1,2,1,21,4,26,27,27,27,28,4,7,5,7,7,3,1,20,1,3,5,1,5,3,1,5,1,10,11,11,12,2,3,1,3,1,23,77,78,78,77,63,78,77,19,56,71,71,55,19,63,78,77,78,77,78,77,79,77,77,71,19,77,77,62,78,77,77,19,71,78,77,77,59,77,79,19,71,77,77,78,75,58,77,77,77,78,63,77,78,77,77,78,58,74,77],
        \\				[77,78,61,74,77,79,78,77,77,78,77,63,77,77,75,71,62,78,77,78,77,63,77,77,78,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,77,62,53,71,61,76,79,77,77,78,77,78,77,77,77,71,77,78,77,77,61,74,77,78,77,71,77,78,78,77,77,78,63,77,77,77,77,77,78,77,77,77,19,63,77,78,20,1,20,7,1,5,2,1,1,19,18,19,1,20,1,20,1,2,20,1,1,73,77,56,78,73,78,77,78,79,78,55,63,20,5,2,0,0,0,2,4,5,0,0,0,4,2,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,0,0,1,61,79,77,61,77,58,59,19,56,71,71,55,19,77,77,78,77,77,77,76,77,78,79,71,19,57,58,57,60,76,79,19,71,77,75,76,58,61,77,19,71,78,77,79,57,63,59,77,79,77,78,77,63,77,75,60,60,79,77],
        \\				[77,78,78,77,77,77,76,62,61,59,77,75,60,61,60,71,61,74,77,77,60,74,75,62,79,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,78,75,76,71,70,60,77,77,78,77,79,77,78,77,78,71,78,77,63,77,78,77,79,77,77,71,77,77,63,77,78,77,77,77,63,61,77,78,77,77,77,77,19,77,79,77,1,50,52,69,68,69,69,70,33,19,33,19,33,70,69,69,68,69,52,50,1,57,78,56,78,57,78,60,57,76,78,55,74,23,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,60,59,75,59,78,62,20,19,56,71,71,55,19,4,76,63,77,62,61,60,79,77,77,71,19,59,79,60,78,61,77,19,71,63,60,57,79,59,78,19,71,77,77,78,62,57,61,62,74,78,77,77,78,78,59,58,61,74,79],
        \\				[63,77,63,77,1,20,1,1,4,1,3,3,76,79,62,71,76,61,1,1,3,4,1,1,20,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,79,78,59,71,53,74,78,79,77,78,77,77,77,77,75,71,77,78,77,77,78,77,77,78,77,71,76,77,77,77,78,63,77,77,77,79,77,77,2,7,3,7,5,61,77,78,8,54,70,18,70,70,66,70,36,18,18,18,36,70,66,70,70,18,70,54,8,77,79,56,63,78,59,61,62,78,79,55,63,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,58,62,61,77,78,76,5,19,56,71,71,55,19,2,60,78,77,20,26,27,27,28,20,71,19,20,26,27,27,28,20,19,71,20,26,27,27,28,20,19,71,5,1,1,2,5,3,1,5,2,4,1,5,77,63,57,58,62,78],
        \\				[77,77,63,77,3,0,0,0,0,0,0,1,60,70,65,71,70,60,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,62,61,62,71,70,62,61,77,2,1,4,5,1,10,11,11,11,12,26,27,27,27,28,10,11,11,11,12,3,1,2,4,1,78,77,78,75,63,7,5,5,5,19,62,74,63,24,33,33,33,18,71,66,67,53,54,54,54,53,67,66,71,18,33,33,33,24,78,60,56,78,79,58,59,76,78,78,55,78,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,76,79,78,63,77,78,4,19,56,71,71,55,19,78,63,78,79,4,0,0,0,0,1,71,19,1,0,0,0,0,1,19,71,5,0,0,0,0,7,19,71,3,0,0,0,0,0,0,0,0,0,0,4,77,63,77,60,76,77],
        \\				[63,77,59,78,4,0,0,0,0,0,0,2,4,26,27,27,28,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,58,59,53,71,60,79,60,76,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,74,77,63,78,77,4,20,23,21,20,60,60,58,24,0,46,0,19,71,54,67,71,18,36,18,71,67,54,71,19,0,47,0,24,73,57,56,78,63,78,78,78,57,61,55,57,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,43,42,43,42,0,0,0,6,20,1,2,1,3,1,7,20,4,1,3,1,2,1,0,0,0,0,0,0,0,0,0,0,0,2,1,3,20,4,5,1,2,1,7,2,4,1,3,6,0,0,0,0,0,0,0,0,41,8,77,59,61,75,77,60,19,56,71,71,55,19,77,78,77,77,1,0,0,0,0,5,71,19,4,0,0,0,0,4,19,71,7,0,0,0,0,5,19,71,4,0,0,0,0,0,0,0,0,0,0,9,79,57,77,63,77,77],
        \\				[75,61,62,78,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,22,2,59,60,71,76,61,58,2,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,63,77,77,75,60,19,61,60,59,19,58,58,62,24,0,0,0,18,70,54,67,71,68,66,68,71,67,54,70,18,0,0,0,24,57,60,56,79,73,57,77,73,62,60,55,77,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,46,0,47,46,0,0,0,20,2,60,58,76,74,57,63,8,19,33,19,17,18,1,2,1,3,1,3,1,4,20,1,1,4,1,35,19,18,33,19,18,33,19,35,1,3,20,1,22,0,0,0,0,0,0,0,0,2,24,77,77,59,58,78,58,19,56,71,71,55,19,60,77,79,77,3,0,0,0,0,5,71,19,1,0,0,0,0,1,19,71,3,0,0,0,0,4,20,7,2,0,0,0,0,0,0,0,0,0,0,25,77,57,59,77,77,77],
        \\				[77,76,77,78,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,27,27,28,20,2,26,27,27,28,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,74,60,62,58,19,62,58,57,19,62,76,2,4,0,0,0,47,18,34,17,71,68,66,68,71,17,34,18,46,0,0,0,4,60,57,56,57,60,60,59,57,74,78,55,60,25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,71,61,57,62,77,79,77,24,19,1,1,2,1,4,1,10,11,11,12,1,2,1,5,4,1,3,1,5,20,1,20,2,1,4,1,7,0,0,0,0,0,0,0,0,42,44,43,44,4,24,5,78,60,62,76,5,19,56,71,71,55,19,5,76,77,78,1,0,0,0,0,3,71,19,5,0,0,0,0,5,3,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,41,62,60,61,77,58,60],
        \\				[78,77,63,77,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,26,27,27,27,28,2,4,1,3,5,4,4,23,22,0,0,0,0,0,45,0,36,35,33,35,36,0,45,0,0,0,0,0,2,5,33,56,34,18,59,60,62,35,18,55,18,41,0,0,0,0,0,0,0,0,0,44,43,0,0,0,0,0,0,0,0,0,0,7,71,60,62,58,75,77,77,24,19,6,0,0,0,0,0,0,0,0,0,0,0,26,27,27,28,0,0,71,0,0,26,27,27,28,0,0,0,0,0,0,0,0,0,0,46,0,45,0,5,24,4,77,63,77,79,20,19,56,71,71,55,19,20,78,63,77,4,0,0,0,0,20,3,5,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,77,78,79,77,78,61],
        \\				[77,63,78,77,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,45,0,0,47,0,0,0,0,0,0,0,3,4,34,19,34,35,70,65,71,70,52,55,35,4,0,0,0,0,0,0,0,0,0,46,46,0,0,0,0,0,0,0,0,0,0,20,71,58,62,60,61,78,79,40,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,40,4,5,3,4,6,5,19,56,4,4,55,19,5,77,77,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,22,3,5,1,4,1,6],
        \\				[77,77,78,77,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,70,70,53,70,70,36,65,71,35,70,55,33,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,43,0,0,0,0,0,20,71,73,79,60,78,77,77,77,78,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,8,1,4,5,1,2,1,3,2,1,35,35,7,1,40,1,4,1,3,1,4,1,4,1,3,1,20,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        \\				[79,77,77,60,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,70,68,71,68,70,18,66,71,18,52,19,35,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,46,46,0,0,0,0,0,5,71,77,63,62,79,79,78,79,77,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,40,53,19,35,70,36,35,33,19,33,36,52,1,0,0,0,0,0,0,71,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        \\				[77,77,1,1,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,2,6,4,1,1,1,2,4,6,4,1,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,5,4,20,2,3,1,1,10,11,11,11,12,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,4,10,12,63,78,76,78,77,77,77,77,9,0,0,0,0,0,3,5,2,3,1,4,1,4,1,6,0,0,71,0,0,6,3,1,5,2,1,3,2,1,1,53,19,33,36,17,53,35,19,18,36,69,7,0,0,0,0,0,0,71,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        \\				[63,60,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,34,3,2,7,3,5,18,4,18,17,17,17,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,22,26,28,5,26,28,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,43,43,42,43,0,0,0,0,0,0,0,24,19,2,71,77,77,63,77,78,63,77,77,25,0,0,0,0,4,7,18,17,33,34,33,18,17,52,4,10,11,11,11,12,4,33,18,33,65,17,34,18,18,34,4,1,26,27,27,28,1,1,3,4,1,3,0,0,0,0,0,0,71,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,5,3,6,0,0,0,0,6,3,1,5,2,1,5,1,1,5,2,1,22],
        \\				[77,62,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42,42,44,43,0,0,0,42,43,42,0,0,0,0,0,0,0,0,0,0,0,0,42,44,42,0,0,0,25,34,18,4,5,4,2,35,19,35,33,33,33,1,2,1,1,5,1,4,2,6,0,0,0,0,0,0,43,42,43,43,42,44,43,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,46,0,0,46,0,0,0,0,0,0,0,24,19,2,71,62,79,78,60,78,77,75,78,41,0,0,0,0,0,4,1,7,5,1,1,3,2,1,22,26,27,27,27,28,22,1,20,3,1,2,20,3,1,1,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,2,4,6,0,0,0,0,1,71,19,3,0,0,0,0,20,17,35,19,35,18,35,35,19,17,17,17,18],
        \\				[77,77,5,0,0,13,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,15,13,0,0,0,6,5,4,2,6,0,0,0,0,0,0,0,0,0,0,46,45,45,46,0,0,0,46,0,46,0,0,0,0,0,0,0,0,0,0,0,0,46,0,46,0,0,0,41,17,69,67,55,20,4,35,19,35,53,53,58,77,63,77,78,63,78,77,4,20,0,0,0,0,0,0,46,0,45,0,45,47,46,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,4,10,12,78,58,78,79,78,18,36,17,22,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,71,0,0,0,0,0,0,0,0,0,0,0,6,4,3,6,0,0,0,0,3,71,19,5,0,0,0,0,2,71,19,2,0,0,0,0,22,1,3,1,1,1,2,1,3,2,1,1,1],
        \\				[60,77,1,0,0,29,30,31,0,0,0,0,0,0,0,0,0,0,0,0,29,30,30,30,31,0,0,0,5,66,71,70,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,22,70,69,70,55,56,70,52,19,52,59,60,61,74,78,76,79,77,76,78,79,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,1,2,1,4,0,0,0,42,44,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,71,78,61,58,78,78,20,2,5,3,23,6,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,3,10,11,11,11,12,1,3,3,0,0,0,0,2,19,71,4,0,0,0,0,1,71,19,1,0,0,0,0,3,71,19,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5],
        \\				[77,77,23,1,2,2,1,1,4,1,3,1,23,1,4,1,1,23,3,1,1,2,5,1,1,3,3,1,1,66,71,70,1,1,4,23,5,1,1,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,4,1,3,23,1,3,1,3,23,1,4,1,3,1,70,69,70,55,56,70,69,19,69,79,75,76,62,77,78,77,78,79,77,75,2,1,1,2,4,1,1,4,1,1,6,1,1,4,1,3,1,1,1,2,6,1,1,3,1,1,21,4,1,1,21,18,33,35,18,20,0,0,0,46,46,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,71,63,77,62,61,63,56,55,19,3,1,5,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,18,35,19,18,35,18,19,35,18,1,81,82,81,82,5,19,71,3,81,82,81,82,4,71,19,2,82,82,81,82,5,71,19,2,81,82,81,82,81,82,82,82,81,81,81,82,81,82,81,82,3],
        \\				[79,78,79,77,78,77,60,59,60,63,77,79,77,77,78,77,78,79,63,77,78,77,78,63,79,60,62,65,69,66,71,70,67,69,60,76,58,59,61,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,19,3,18,7,20,4,19,20,7,6,20,18,5,2,65,69,67,55,56,70,69,71,69,77,58,61,60,73,62,60,63,78,77,78,60,61,77,77,78,77,77,78,77,77,79,61,75,61,76,61,63,77,78,77,77,79,77,79,77,77,77,76,60,61,77,77,78,77,77,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,71,78,79,60,60,78,56,55,19,1,2,22,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,36,33,19,52,52,52,19,33,36,2,89,90,90,89,1,19,71,2,90,89,89,90,1,71,19,4,89,90,89,90,7,71,19,3,90,90,89,90,89,90,89,89,90,90,89,89,90,90,89,89,1],
        \\				[77,79,77,77,79,78,63,58,77,77,63,78,77,63,77,77,77,78,77,77,79,77,78,63,77,77,75,60,61,66,71,62,76,59,61,59,62,60,58,1,1,3,1,1,23,1,4,1,1,7,1,1,7,1,1,4,1,4,19,2,4,5,20,23,19,2,5,21,7,4,20,53,53,53,71,55,56,70,69,71,69,62,60,57,59,76,79,57,77,78,77,63,60,61,77,79,77,63,78,77,79,77,74,62,60,60,60,62,58,77,63,77,77,78,77,77,77,78,78,77,59,77,63,77,77,77,79,1,1,4,1,1,6,1,1,1,6,1,1,1,6,1,1,1,6,1,1,1,71,78,77,79,77,78,56,55,19,2,3,1,1,5,1,3,2,3,1,3,1,4,1,5,3,1,4,1,2,10,11,11,11,12,5,1,4,1,2,5,4,10,11,11,11,12,1,10,11,11,11,12,5,1,2,1,22,35,18,19,33,33,18,19,17,17,1,3,5,4,19,1,19,71,1,3,19,4,5,1,71,19,1,5,1,19,5,1,71,19,1,1,3,1,19,2,5,1,5,1,19,2,4,5,1,20,1,20]
        \\			]
        \\		}
    );

    map.setAnim(80, 0.13, &[_]u16{ 80, 81, 82, 83, 84, 85, 86, 87 });
    map.setAnim(81, 0.17, &[_]u16{ 84, 83, 82, 81, 80, 87, 86, 85 });
    map.setAnim(88, 0.23, &[_]u16{ 88, 89, 90, 91, 92, 93, 94, 95 });
    map.setAnim(89, 0.19, &[_]u16{ 95, 94, 93, 92, 91, 90, 89, 88 });

    blob_entity = engine.spawn(.blob, vec2(0, 0));
    player_entity = engine.spawn(.player, vec2(0, 0));
    title.scene_title.init.?();
}

export fn update() void {
    render.framePrepare();
    title.scene_title.update.?();
    title.scene_title.draw.?();
    engine.drawEntity(&blob_entity, vec2(100, 0));
    engine.drawEntity(&player_entity, vec2(0, 100));
    engine.update();
}

export fn cleanup() void {
    engine.cleanup();
}

pub fn main() void {
    sapp.run(.{
        .init_cb = init,
        .frame_cb = update,
        .cleanup_cb = cleanup,
        .window_title = "Z Impact Game",
        .width = 1280,
        .height = 720,
    });
}
